<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema de Cupons</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { text-align: center; }
    .container { max-width: 500px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input, button, select { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
    .cupom-item { background: #e9e9e9; padding: 10px; margin-top: 5px; border-radius: 5px; }
    #loginBox { max-width: 350px; margin: 0 auto; }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="loginBox" class="container">
    <h2>Login do Administrador</h2>
    <label>Senha:</label>
    <input type="password" id="senhaLogin" placeholder="Digite a senha" />
    <button onclick="fazerLogin()">Entrar</button>
  </div>

  <!-- SISTEMA -->
  <div id="app" class="container" style="display:none;">
    <h1>Cadastro de Cupons</h1>

    <label>Nome do Cliente:</label>
    <input type="text" id="nome" placeholder="Ex: Maria Silva" />

    <label>Tipo de Cliente:</label>
    <select id="tipoCliente" onchange="mostrarEmpresa()">
      <option value="avista">Cliente à Vista</option>
      <option value="empresa">Cliente Empresa</option>
    </select>

    <div id="campoEmpresa" style="display:none;">
      <label>Nome da Empresa:</label>
      <input type="text" id="empresa" placeholder="Nome da empresa" />
    </div>

    <label>Número do Cupom Fiscal:</label>
    <input type="text" id="cupom" placeholder="Ex: 123456" />

    <button onclick="adicionarCupom()">Cadastrar Cupom</button>

    <h2>Cupons Cadastrados</h2>
    <div id="lista"></div>

    <button onclick="exportar()" style="background: green; margin-top:20px;">Exportar para Sorteio</button>
  </div>

  <script>
    const SENHA_CORRETA = "@Dp10092015@"; // altere aqui a senha

    let cupons = JSON.parse(localStorage.getItem('cupons')) || [];

    function fazerLogin() {
      const senha = document.getElementById('senhaLogin').value;
      if (senha === SENHA_CORRETA) {
        document.getElementById('loginBox').style.display = 'none';
        document.getElementById('app').style.display = 'block';
      } else {
        alert('Senha incorreta!');
      }
    }

    function mostrarEmpresa() {
      const tipo = document.getElementById('tipoCliente').value;
      document.getElementById('campoEmpresa').style.display = tipo === 'empresa' ? 'block' : 'none';
    }

    function atualizarLista() {
      const lista = document.getElementById('lista');
      lista.innerHTML = '';
      cupons.forEach(c => {
        lista.innerHTML += `<div class='cupom-item'><strong>${c.cupom}</strong> - ${c.nome} (${c.tipo}${c.empresa ? ' - ' + c.empresa : ''})</div>`;
      });
    }

    function adicionarCupom() {
      const nome = document.getElementById('nome').value.trim();
      const cupom = document.getElementById('cupom').value.trim();
      const tipo = document.getElementById('tipoCliente').value;
      const empresa = document.getElementById('empresa').value.trim();

      if (!nome || !cupom) {
        alert('Preencha todos os campos obrigatórios.');
        return;
      }

      if (tipo === 'empresa' && !empresa) {
        alert('Informe o nome da empresa.');
        return;
      }

      if (cupons.some(c => c.cupom === cupom)) {
        alert('Este número de cupom já está cadastrado!');
        return;
      }

      cupons.push({ nome, cupom, tipo, empresa: tipo === 'empresa' ? empresa : '' });
      localStorage.setItem('cupons', JSON.stringify(cupons));
      atualizarLista();

      document.getElementById('nome').value = '';
      document.getElementById('cupom').value = '';
      document.getElementById('empresa').value = '';
      document.getElementById('tipoCliente').value = 'avista';
      mostrarEmpresa();
    }

    function exportar() {
      const texto = cupons.map(c => `${c.cupom};${c.nome};${c.tipo};${c.empresa}`).join('\n');
      const blob = new Blob([texto], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);

      const a = document.createElement('a');
      a.href = url;
      a.download = 'cupons_sorteio.txt';
      a.click();
    }

    atualizarLista();
  </script>
</body>
</html>
