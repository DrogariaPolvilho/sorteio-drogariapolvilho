<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema de Cupons</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { text-align: center; }
    .container { max-width: 500px; margin: 0 auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    input, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { background: #007bff; color: white; border: none; cursor: pointer; }
    button:hover { background: #0056b3; }
    .cupom-item { background: #e9e9e9; padding: 10px; margin-top: 5px; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Cadastro de Cupons</h1>
    <label>Nome do Cliente:</label>
    <input type="text" id="nome" placeholder="Ex: Maria Silva" />

    <label>Número do Cupom Fiscal:</label>
    <input type="text" id="cupom" placeholder="Ex: 123456" />

    <button onclick="adicionarCupom()">Cadastrar Cupom</button>

    <h2>Cupons Cadastrados</h2>
    <div id="lista"></div>

    <button onclick="exportar()" style="background: green; margin-top:20px;">Exportar para Sorteio</button>
  </div>

  <script>
    // Carrega cupons do localStorage
    let cupons = JSON.parse(localStorage.getItem('cupons')) || [];

    function atualizarLista() {
      const lista = document.getElementById('lista');
      lista.innerHTML = '';
      cupons.forEach(c => {
        // CORREÇÃO APLICADA AQUI
        lista.innerHTML += `<div class='cupom-item'><strong>${c.cupom}</strong> - ${c.nome}</div>`;
      });
    }

    function adicionarCupom() {
      const nome = document.getElementById('nome').value.trim();
      const cupom = document.getElementById('cupom').value.trim();

      if (!nome || !cupom) {
        alert('Preencha todos os campos.');
        return;
      }

      // Verifica duplicata
      if (cupons.some(c => c.cupom === cupom)) {
        alert('Este número de cupom já está cadastrado!');
        return;
      }

      cupons.push({ nome, cupom });
      localStorage.setItem('cupons', JSON.stringify(cupons));
      atualizarLista();
      document.getElementById('nome').value = '';
      document.getElementById('cupom').value = '';
    }

    function exportar() {
      // CORREÇÃO APLICADA AQUI
      const texto = cupons.map(c => `${c.cupom};${c.nome}`).join('\n');
      const blob = new Blob([texto], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);

      const a = document.createElement('a');
      a.href = url;
      a.download = 'cupons_sorteio.txt';
      a.click();
    }

    atualizarLista();
  </script>
</body>
</html>